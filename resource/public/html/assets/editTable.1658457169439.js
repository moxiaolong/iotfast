var q=Object.defineProperty;var D=Object.getOwnPropertySymbols;var G=Object.prototype.hasOwnProperty,O=Object.prototype.propertyIsEnumerable;var R=(u,m,i)=>m in u?q(u,m,{enumerable:!0,configurable:!0,writable:!0,value:i}):u[m]=i,N=(u,m)=>{for(var i in m||(m={}))G.call(m,i)&&R(u,i,m[i]);if(D)for(var i of D(m))O.call(m,i)&&R(u,i,m[i]);return u};import{j,aB as z,a as I,$ as M,d as H,ac as Q,M as C,O as o,_ as r,k as p,V as e,l as E,a3 as v,m as h,U as w,F as g,c as K,T as P}from"./vue.1658457169439.js";import{u as W,g as S,a as J}from"./gen.1658457169439.js";import X from"./basicInfoForm.1658457169439.js";import Y from"./genInfoForm.1658457169439.js";import{_ as Z,E as L}from"./index.1658457169439.js";const ee=j({name:"GenTableEdit",components:{basicInfoForm:X,genInfoForm:Y},setup(u,{emit:m}){const{proxy:i}=K(),B=z(),x=I(),A=I(),y=I(null),s=M({tableId:0,activeName:"cloum",tableHeight:document.documentElement.scrollHeight-245+"px",cloumns:[],dictOptions:[],info:{},relationTable:[]}),T=()=>{console.log("have been submit form");const d=i.$refs.basicInfoRef.info,b=i.$refs.genInfoRef.info;console.log("basicForm:",d,"genForm:",b),Promise.all([d,b]).then(f=>{if(f.every(c=>!!c)){const c=Object.assign({},d,b);c.columns=s.cloumns,c.params={treeCode:c.treeCode,treeName:c.treeName,treeParentCode:c.treeParentCode},W(c).then(k=>{L.success("\u6570\u636E\u4FDD\u5B58\u6210\u529F!"),k.code===0&&t()})}else L.error("\u8868\u5355\u6821\u9A8C\u672A\u901A\u8FC7\uFF0C\u8BF7\u91CD\u65B0\u68C0\u67E5\u63D0\u4EA4\u5185\u5BB9")})},n=d=>{s.info.column=d},V=d=>new Promise(b=>{d.validate(f=>{b(f)})}),t=()=>{i.mittBus.emit("onCurrentContextmenuClick",Object.assign({},N({contextMenuClickId:1},B)))},_=(d,b)=>{s.relationTable.filter(function(f){f.tableName===d.linkTableName&&(d.fkCol=f.columns)})},F=()=>{s.tableId=B.query.tableId,s.tableId&&(S(s.tableId).then(d=>{let b=[];b=d.data.list.filter(f=>!["created_by","updated_by","updated_at","deleted_at"].includes(f.columnName)),s.cloumns=b,s.info=d.data.Info}),J().then(d=>{s.relationTable=d.data.list}))};return H(()=>{F()}),N({basicInfoRef:A,genInfoRef:x,formRef:y,submitForm:T,setInfoColumn:n,getFormPromise:V,close:t,handleChangeConfig:_,beforeCreate:F},Q(s))}}),le={style:{float:"left"}},ae={style:{float:"right",color:"#8492a6","font-size":"13px"}},te={style:{float:"left"}},oe={style:{float:"right",color:"#8492a6","font-size":"13px"}},ue={style:{float:"left"}},ne={style:{float:"right",color:"#8492a6","font-size":"13px"}},de={style:{float:"left"}},ie={style:{float:"right",color:"#8492a6","font-size":"13px"}},re=P("\u63D0\u4EA4"),me=P("\u8FD4\u56DE");function se(u,m,i,B,x,A){const y=r("basicInfoForm"),s=r("el-tab-pane"),T=r("el-alert"),n=r("el-table-column"),V=r("el-input"),t=r("el-option"),_=r("el-select"),F=r("el-checkbox"),d=r("el-table"),b=r("genInfoForm"),f=r("el-tabs"),U=r("el-button"),c=r("el-form-item"),k=r("el-form"),$=r("el-card");return p(),C($,null,{default:o(()=>[e(f,{modelValue:u.activeName,"onUpdate:modelValue":m[0]||(m[0]=l=>u.activeName=l)},{default:o(()=>[e(s,{label:"\u57FA\u672C\u4FE1\u606F",name:"basic"},{default:o(()=>[e(y,{ref:"basicInfoRef",info:u.info},null,8,["info"])]),_:1}),e(s,{label:"\u5B57\u6BB5\u4FE1\u606F",name:"cloum"},{default:o(()=>[e(T,{title:"\u26A0\uFE0F\u8868\u5B57\u6BB5\u4E2D\u7684created_by\u3001updated_by\u3001updated_at\u3001deleted_at\u7684\u5B57\u6BB5\u5728\u6B64\u5217\u8868\u4E2D\u5DF2\u7ECF\u9690\u85CF",type:"warning","show-icon":""}),e(d,{ref:"dragTable",data:u.cloumns,"row-key":"columnId","max-height":u.tableHeight,width:"100%"},{default:o(()=>[e(n,{label:"\u5E8F\u53F7",type:"index",width:"50",fixed:""}),e(n,{label:"\u5B57\u6BB5\u5217\u540D",prop:"columnName",width:"150",fixed:"","show-overflow-tooltip":!0}),e(n,{label:"\u5B57\u6BB5\u63CF\u8FF0",width:"150",fixed:""},{default:o(l=>[e(V,{modelValue:l.row.columnComment,"onUpdate:modelValue":a=>l.row.columnComment=a},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),e(n,{"class-name":"allowDrag",label:"\u7269\u7406\u7C7B\u578B",prop:"columnType",width:"120","show-overflow-tooltip":!0}),e(n,{label:"go\u7C7B\u578B",width:"120"},{default:o(l=>[e(_,{modelValue:l.row.goType,"onUpdate:modelValue":a=>l.row.goType=a},{default:o(()=>[e(t,{label:"int",value:"int"}),e(t,{label:"uint",value:"uint"}),e(t,{label:"int64",value:"int64"}),e(t,{label:"uint64",value:"uint64"}),e(t,{label:"float64",value:"float64"}),e(t,{label:"string",value:"string"}),e(t,{label:"Time",value:"Time"}),e(t,{label:"byte",value:"byte"}),e(t,{label:"bool",value:"bool"})]),_:2},1032,["modelValue","onUpdate:modelValue"])]),_:1}),e(n,{label:"go\u5C5E\u6027",width:"150"},{default:o(l=>[e(V,{modelValue:l.row.goField,"onUpdate:modelValue":a=>l.row.goField=a},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),e(n,{label:"json\u5C5E\u6027",width:"150"},{default:o(l=>[e(V,{modelValue:l.row.htmlField,"onUpdate:modelValue":a=>l.row.htmlField=a},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),e(n,{label:"\u63D2\u5165",width:"50"},{default:o(l=>[e(F,{"true-label":"1",modelValue:l.row.isInsert,"onUpdate:modelValue":a=>l.row.isInsert=a,disabled:l.row.isPk=="1"||l.row.columnName=="created_at"},null,8,["modelValue","onUpdate:modelValue","disabled"])]),_:1}),e(n,{label:"\u7F16\u8F91",width:"50"},{default:o(l=>[e(F,{"true-label":"1",modelValue:l.row.isEdit,"onUpdate:modelValue":a=>l.row.isEdit=a,disabled:l.row.isPk=="1"||l.row.columnName=="created_at"},null,8,["modelValue","onUpdate:modelValue","disabled"])]),_:1}),e(n,{label:"\u5217\u8868",width:"50"},{default:o(l=>[e(F,{"true-label":"1",modelValue:l.row.isList,"onUpdate:modelValue":a=>l.row.isList=a,disabled:l.row.htmlField==u.info.treeParentCode},null,8,["modelValue","onUpdate:modelValue","disabled"])]),_:1}),e(n,{label:"\u67E5\u8BE2",width:"50"},{default:o(l=>[e(F,{"true-label":"1",modelValue:l.row.isQuery,"onUpdate:modelValue":a=>l.row.isQuery=a,disabled:l.row.htmlField==u.info.treeParentCode},null,8,["modelValue","onUpdate:modelValue","disabled"])]),_:1}),e(n,{label:"\u67E5\u8BE2\u65B9\u5F0F",width:"120"},{default:o(l=>[e(_,{modelValue:l.row.queryType,"onUpdate:modelValue":a=>l.row.queryType=a},{default:o(()=>[e(t,{label:"=",value:"EQ"}),e(t,{label:"!=",value:"NE"}),e(t,{label:">",value:"GT"}),e(t,{label:">=",value:"GTE"}),e(t,{label:"<",value:"LT"}),e(t,{label:"<=",value:"LTE"}),e(t,{label:"LIKE",value:"LIKE"}),e(t,{label:"BETWEEN",value:"BETWEEN"})]),_:2},1032,["modelValue","onUpdate:modelValue"])]),_:1}),e(n,{label:"\u5FC5\u586B",width:"50"},{default:o(l=>[e(F,{"true-label":"1",modelValue:l.row.isRequired,"onUpdate:modelValue":a=>l.row.isRequired=a},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),e(n,{label:"\u663E\u793A\u7C7B\u578B",width:"140"},{default:o(l=>[e(_,{modelValue:l.row.htmlType,"onUpdate:modelValue":a=>l.row.htmlType=a,disabled:l.row.htmlField==u.info.treeParentCode},{default:o(()=>[e(t,{label:"\u6587\u672C\u6846",value:"input"}),e(t,{label:"\u6587\u672C\u57DF",value:"textarea"}),e(t,{label:"\u4E0B\u62C9\u6846",value:"select"}),e(t,{label:"\u5355\u9009\u6846",value:"radio"}),e(t,{label:"\u590D\u9009\u6846",value:"checkbox"}),e(t,{label:"\u65E5\u671F\u63A7\u4EF6",value:"date"}),e(t,{label:"\u65E5\u671F\u65F6\u95F4\u63A7\u4EF6",value:"datetime"}),e(t,{label:"\u5BCC\u6587\u672C",value:"richtext"}),e(t,{label:"\u5355\u56FE\u4E0A\u4F20",value:"imagefile"}),e(t,{label:"\u591A\u56FE\u4E0A\u4F20",value:"images"}),e(t,{label:"\u5355\u6587\u4EF6\u4E0A\u4F20",value:"file"}),e(t,{label:"\u591A\u6587\u4EF6\u4E0A\u4F20",value:"files"})]),_:2},1032,["modelValue","onUpdate:modelValue","disabled"])]),_:1}),e(n,{label:"\u5B57\u5178\u7C7B\u578B",width:"160"},{default:o(l=>[e(_,{modelValue:l.row.dictType,"onUpdate:modelValue":a=>l.row.dictType=a,clearable:"",filterable:"",placeholder:"\u8BF7\u9009\u62E9"},{default:o(()=>[(p(!0),E(g,null,v(u.dictOptions,a=>(p(),C(t,{key:a.dictType,label:a.dictName,value:a.dictType},{default:o(()=>[h("span",le,w(a.dictName),1),h("span",ae,w(a.dictType),1)]),_:2},1032,["label","value"]))),128))]),_:2},1032,["modelValue","onUpdate:modelValue"])]),_:1}),e(n,{label:"\u5173\u8054\u8868",width:"160"},{default:o(l=>[e(_,{modelValue:l.row.linkTableName,"onUpdate:modelValue":a=>l.row.linkTableName=a,clearable:"",filterable:"",placeholder:"\u8BF7\u9009\u62E9",onChange:a=>u.handleChangeConfig(l.row,l.$index)},{default:o(()=>[(p(!0),E(g,null,v(u.relationTable,a=>(p(),C(t,{key:a.tableName,label:a.tableName,value:a.tableName},{default:o(()=>[h("span",te,w(a.tableName),1),h("span",oe,w(a.tableComment),1)]),_:2},1032,["label","value"]))),128))]),_:2},1032,["modelValue","onUpdate:modelValue","onChange"])]),_:1}),e(n,{label:"\u5173\u8054\u8868key",width:"150"},{default:o(l=>[e(_,{modelValue:l.row.linkLabelId,"onUpdate:modelValue":a=>l.row.linkLabelId=a,clearable:"",filterable:"",placeholder:"\u8BF7\u9009\u62E9"},{default:o(()=>[(p(!0),E(g,null,v(l.row.fkCol,a=>(p(),C(t,{key:a.columnName,label:a.columnName,value:a.htmlField},{default:o(()=>[h("span",ue,w(a.htmlField),1),h("span",ne,w(a.columnComment),1)]),_:2},1032,["label","value"]))),128))]),_:2},1032,["modelValue","onUpdate:modelValue"])]),_:1}),e(n,{label:"\u5173\u8054\u8868value",width:"150"},{default:o(l=>[e(_,{modelValue:l.row.linkLabelName,"onUpdate:modelValue":a=>l.row.linkLabelName=a,clearable:"",filterable:"",placeholder:"\u8BF7\u9009\u62E9"},{default:o(()=>[(p(!0),E(g,null,v(l.row.fkCol,a=>(p(),C(t,{key:a.columnName,label:a.columnName,value:a.htmlField},{default:o(()=>[h("span",de,w(a.htmlField),1),h("span",ie,w(a.columnComment),1)]),_:2},1032,["label","value"]))),128))]),_:2},1032,["modelValue","onUpdate:modelValue"])]),_:1})]),_:1},8,["data","max-height"])]),_:1}),e(s,{label:"\u751F\u6210\u4FE1\u606F",name:"genInfo"},{default:o(()=>[e(b,{ref:"genInfoRef",info:u.info},null,8,["info"])]),_:1})]),_:1},8,["modelValue"]),e(k,{"label-width":"100px"},{default:o(()=>[e(c,{style:{"text-align":"center","margin-left":"-100px","margin-top":"10px"}},{default:o(()=>[e(U,{type:"primary",onClick:u.submitForm},{default:o(()=>[re]),_:1},8,["onClick"]),e(U,{onClick:u.close},{default:o(()=>[me]),_:1},8,["onClick"])]),_:1})]),_:1})]),_:1})}var he=Z(ee,[["render",se]]);export{he as default};
